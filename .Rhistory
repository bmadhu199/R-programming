install.packages("car")
install.packages("car")
library(car)
library(car)
library(car)
install.packages("car")
install.packages("curl")
install.packages("curl")
library(car)
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
install.packages("data.tabl")
install.packages("data.table")
library(car)
library(car)
Prestige
View(Prestige)
colSums(Prestige)
is.na(Prestige)
is.na(Prestige$type)
colSums(Prestige,na.rm = TRUE)
colSums(Prestige,na.rm = TRUE)
colSums(is.na(Prestige))
Prestige[is.na(Prestige$type),]
data <- Prestige[,-c(5,6)]
data
training_set = sample(1: nrow(data), round(0.85* nrow(data))
set.seed(199)
training_set = sample(1: nrow(data), round(0.85* nrow(data))
set.seed(123)
training_set = sample(1: nrow(data), round(0.85* nrow(data))
set.seed(123)
training_set = sample(1: nrow(data), round(0.85* nrow(data))
training_set = sample(1: nrow(data), round(0.85* nrow(data)))
set.seed(123)
training_car_set = sample(1: nrow(data), round(0.85* nrow(data)))
train_set = data[training_car_set]
train_set = Prestige[training_car_set]
train_set = Prestige[training_car_set,]
set.seed(123)
training_car_set = sample(1: nrow(data), round(0.85* nrow(data)))
car_train_set = Prestige[training_car_set,]
car_test_set =  Prestige[-training_car_set,]
training_income_set = sample(1: nrow(data), round(0.85* nrow(data)))
set.seed(123)
training_income_set = sample(1: nrow(data), round(0.85* nrow(data)))
income_train_set = Prestige[training_car_set,]
income_test_set =  Prestige[-training_car_set,]
View(Prestige)
ggplot(Prestige,aes(x= income,y= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
library(ggplot2)
library(dplyr)
library(dplyr)
library(ggplot2)
ggplot(Prestige,aes(x= income,y= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
ggplot(Prestige,aes(x= income,y= women))+geom_point(color ='red')+ggtitle('income VS women')+ylab("income")+xlab("women")
ggplot(Prestige,aes(x= income,y= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
ggplot(Prestige,aes(x= income,y= education))+geom_point(color ='red')+ggtitle('income VS education')+ylab("income")+xlab("education")
ggplot(Prestige,aes(x= income,y= women))+geom_point(color ='red')+ggtitle('income VS women')+ylab("income")+xlab("women")
ggplot(Prestige,aes(x= log(income,y= women)))+geom_point(color ='red')+ggtitle('income VS women')+ylab("income")+xlab("women")
ggplot(Prestige,aes(y= log(income),x= women))+geom_point(color ='red')+ggtitle('income VS women')+ylab("income")+xlab("women")
ggplot(Prestige,aes(x= income,y= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
ggplot(Prestige,aes(y= income,x= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
ggplot(Prestige,aes(y= income,x= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
ggplot(Prestige,aes(y= income,x= education))+geom_point(color ='red')+ggtitle('income VS education')+ylab("income")+xlab("education")
ggplot(Prestige,aes(y= (income),x= women))+geom_point(color ='red')+ggtitle('income VS women')+ylab("income")+xlab("women")
reg_model <- lm(data$income ~ data$prestige + data$education + data$women , data = income_train_set)
summary(reg_model)
reg_model <- lm((data$income)**2 ~ data$prestige + data$education + data$women , data = income_train_set)
summary(reg_model)
reg_model <- lm(sqrt(data$income) ~ data$prestige + data$education + data$women , data = income_train_set)
summary(reg_model)
reg_model <- lm(log(data$income) ~ data$prestige + data$education + data$women , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
predict(reg_model,income_train_set)
predict(reg_model,income_test_set)
reg_model <- lm(log(income_train_set$income) ~ income_train_set$prestige + income_train_set$education + income_train_set$women , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
summary(reg_model)
reg_model <- lm(log(income_train_set$income) ~ income_train_set$prestige + income_train_set$education + income_train_set$women , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
data <- Prestige[,-c(5,6)]
income_train_set = data[training_income_set,]
income_test_set =  data[-training_income_set,]
reg_model <- lm(log(income_train_set$income) ~ income_train_set$prestige + income_train_set$education + income_train_set$women , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
data <- Prestige[,-c(5,6)]
training_income_set = sample(1: nrow(data), round(0.85* nrow(data)))
rm(list = ls())
data <- Prestige[,-c(5,6)]
set.seed(123)
training_income_set = sample(1: nrow(data), round(0.85* nrow(data)))
income_train_set = data[training_income_set,]
income_test_set =  data[-training_income_set,]
ggplot(Prestige,aes(y= income,x= prestige))+geom_point(color ='red')+ggtitle('income VS prestige')+ylab("income")+xlab("prestige")
ggplot(Prestige,aes(y= income,x= education))+geom_point(color ='red')+ggtitle('income VS education')+ylab("income")+xlab("education")
ggplot(Prestige,aes(y= (income),x= women))+geom_point(color ='red')+ggtitle('income VS women')+ylab("income")+xlab("women")
summary(reg_model)
reg_model <- lm(log(income_train_set$income) ~ income_train_set$prestige + income_train_set$education + income_train_set$women , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
predict(reg_model,income_test_set)
View(data)
reg_model <- lm(log(income_train_set$income) ~ . , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
install.packages("Metrics")
library(Metrics)
rmse(predict(reg_model,income_test_set))
rmse(predicted = reg_model)
predict(reg_model,income_test_set)
exp(predict(reg_model,income_test_set))
write.csv(data,row.names = FALSE)
write.csv(data,"data.csv",row.names = FALSE)
reg_model <- lm(log(income_train_set$income) ~ . , data = income_train_set)
summary(reg_model)
View(Prestige)
?step()
step(reg_model,direction = "backward")
step(reg_model,direction = "forward")
step(reg_model,direction = "backward")
reg_model <- lm(income_train_set$income ~ . , data = income_train_set)
summary(reg_model)
reg_model <- lm(income_train_set$income ~ women + prestige , data = income_train_set)
summary(reg_model)
reg_model <- lm(log(income_train_set$income) ~ women + prestige , data = income_train_set)
summary(reg_model)
predict(reg_model,income_test_set)
exp(predict(reg_model,income_test_set))
rmse(predicted = reg_model)
rmse(actual = income_test_set ,predicted = reg_model)
library(Metrics)
rmse(actual = income_test_set ,predicted = reg_model)
rmse(actual = income_test_set$income ,predicted = predict(reg_model,income_test_set))
exp(predict(reg_model,income_test_set))
predict_exp <- exp(predict(reg_model,income_test_set))
rmse(actual = income_test_set$income ,predicted = predict_exp)
